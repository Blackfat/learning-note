## 架构设计原则

### 业务架构

- *遵循“高内聚，低耦合”的原则*
- *明确核心业务，核心业务精简化，利于稳定*

### 应用架构

- **稳定**

- - *以稳定为中心*
  - *架构尽可能简单、清晰，追求小而美，不要大而全*

- - *不过度设计*

- **解耦**

- - *将稳定部分与易变部分分离*
  - *将核心业务与非核心业务分离*

- - *将主流程和辅助流程分离*
  - *将应用与数据分离*

- - *将服务和实现细节分离*

- **抽象**

- - *应用抽象化：应用只依赖服务抽象，不依赖服务实现的细节和位置*
  - *数据库抽象化：应用只依赖逻辑数据库，不需要关心物理库的位置和分片*

- - *服务抽象化：应用虚拟化部署，不需要关心实体机的配置，动态调配资源*

- **松耦合**

- - *跨域调用异步化：在不同的业务域之间尽量异步解耦*
  - *非核心业务尽量异步化：在核心业务和非核心业务之间尽量异步化*

- - *在必须同步调用时，需要设置超时时间和任务队列的长度*

- **容错设计**

- - *服务自治：服务能彼此独立修改、部署、发布和管理，避免引发连锁反应*
  - *集群容错：应用系统集群部署，避免单点服务*

- - *多机房容灾：多机房部署、多活*

### 技术架构

- **无状态**

- - *尽量不要把状态数据保存在本机上*

- **可复用**

- - *复用粒度是有业务逻辑的抽象服务，不是服务的实现细节*
  - *服务引用只依赖服务抽象*

- **松耦合**

- - *跨业务域调用，尽可能异步解耦*
  - *在同步调用时设置超时时间和队列大小*

- - *将相对稳定的基础服务与易变流程服务分离*

- **可治理**

- - *服务可降级*
  - *服务可限流*

- - *服务可开关*
  - *服务可监控*

- - *白名单机制*
  - *制定服务契约*

- **基础服务**

- - *基础服务下沉、可复用，例如时效、库存和价格计算*
  - *基础服务自治、相对独立*

- - *对基础服务的实现要精简，并可水平扩展*
  - *对基础服务的实现要进行物理隔离，包括基础服务相关的数据*

### 业务架构和系统架构的区别

*业务架构是对业务需求的提炼和抽象，使用一套方法论对产品（项目）所涉及需求的业务进行业务边界划分，简单地讲就是根据一套逻辑思路进行业务的拆分*。可拆分场景，业务，中台业务，基础服务层

系统架构是基于业务愿景及业务架构，表达系统分层、系统域的定义及域的边界。可拆分展示层，接入层，应用层，业务服务层，基础服务层，基础设施层。

*业务架构和系统架构的区别在于业务架构聚焦在业务层面，从业务的视角对架构进行业务边界划分和分层，而系统架构则是从软件系统的视角对架构进行分层和抽象，需要指出系统的层次、系统开发的原则、系统各个层次的核心应用服务。*

