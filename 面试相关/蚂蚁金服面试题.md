## 蚂蚁金服面试题

### JVM参数调优

##### JVM堆的组成

- 新生代

  保存新生成的对象，根据JVM的策略，经过几次垃圾回收以后，没有被垃圾回收的对象将会移动到老年代，当新生代空间溢出时，会抛出java heap space的错误。新生代可以细分为Eden和两个survivor区域，默认比列8:1:1可以通过－XX:SurvivorRatio来设置。虚拟机每次只会使用Eden和Survivor中的一块来存储对象，另一个区域是空闲的。新生代在经历MinorGC后，如果还有对象活着，并且能够被另一个Survivor区域所容纳，则使用复制算法将这些对象复制到另一个Survivor区域，并且将对象的年龄置为1，以后对象在survivor区域每经历一次GC后，年龄都会加1，当达到某个之后，（默认15，可以通过－XX:MaxTenuringThreshold设置）这些对象就会移动到老年代

- 老年代

  保存生命周期长的对象，多次未被gc掉的对象

- 永久代（方法区）

  保存类、方法、字段对象，这部分空间一般不会溢出，除非一次性加载了很多对象，会抛出PermGen space


​       -Xms：参数设置了JVM启动初始化内存

  	-Xmx：参数设置JVM堆的最大内存       

​       -Xmn：参数设置新生代的大小；老年代等于-Xmx减去-Xmn

​      -XX:PermSize：参数设置了永久代的的大小

​     -XX:MaxPermSize：参数设置永久代的最大值

### JAVA垃圾回收算法

##### 对象是否可以回收

- 引用计数算法

  存储特定对象的所有引用数，当应用程序创建引用以及引用超出范围时，JVM必须适当的减少引用数，当某对象的引用数为0时，便可以进行垃圾收集（优点：实现简单、效率高；缺点：很难解决对象之间的相互引用问题）

- 可达性分析算法

  通过一系列称为GC Roots的对象作为起始点，从这些节点开始向下搜索，搜索所走的路径称为引用链，当一个对象到GC Roots没有任何引用链时，则证明此对象时不可用的（GC Roots包括虚拟机栈中的引用对象，方法去区中的静态属性引用对象，方法去中的常量引用对象）

##### JVM的垃圾回收策略

- 标记－清除算法（适用于老年代）

  首先根据可达性分析算法，标记处所有需要回收的对象，在标记完成后统一回收所有对象，缺点时标记和清除两个过程效率低，同时会产生大量不连续的内存碎片，可能在下次程序运行中需要分配大内存对象时，不得不提前出发一次垃圾收集动作

- 复制算法（适用于新生代）

- 分代收集策略

  新生代使用复制算法

  老年代使用标记－清除算法

- 回收方法区（适用于永久代）

  废弃常量和无用的类

### 分布式唯一GUID

mongodb的objectID的生产规则：4位时间戳+3位机器唯一标识+2位进程id+3位自动累加的计数器

### 防止重复数据

### 数据库连接池

J2EE服务器启动的时候回建立一定数量的池连接，并一直维护不少于此数据的池连接。客户端程序需要连接时，连接池程序会返回一个未使用的池连接并将其标记为忙。如果当前没有空闲连接，池程序就新建一定数量的连接，新增连接池的数目由配置参数决定。当使用的池连接调用完成后，池程序将此连接标记为空间，其他调用就可以使用这个连接。

### SpringMVC的工作机制

Spring mvc将所有的请求都提交给DispatcherServlet，它会委托其他模块对请求进行真正的处理工作。DispatcherServlet查询一个或多个HandlerMapping,

找到处理请求的controller。controller对请求处理后，会返回一个逻辑的视图。DispatcherServlet查询一个或多个视图解析器。找到逻辑视图对应的视图对象。视图对象负责渲染返回给客户端

